(this.webpackJsonpbloglist=this.webpackJsonpbloglist||[]).push([[0],{21:function(e,t,n){e.exports=n(45)},44:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(17),l=n.n(o),u=n(3),c=n.n(u),i=n(5),s=n(7),d=n(1),m=function(e){var t=e.title,n=e.author,o=e.url,l=e.votes,u=e.addVote,c=e.removeBlog,i=Object(a.useState)(!1),s=Object(d.a)(i,2),m=s[0],f=s[1],g={display:m?"none":""},v={display:m?"":"none"};return r.a.createElement("td",null,r.a.createElement("div",{style:g,className:"BlogShow"},t," - ",n,r.a.createElement("button",{id:"showmore-button",onClick:function(){return f(!0)}},"show more"),r.a.createElement("button",{id:"remove-button",className:"remove",onClick:c},"remove")),r.a.createElement("div",{style:v,className:"BlogHide"},r.a.createElement("ul",null,t,r.a.createElement("button",{id:"showless-button",onClick:function(){return f(!1)}},"show less"),r.a.createElement("button",{id:"remove-button",className:"remove",onClick:c},"remove")),r.a.createElement("ul",null,"by: ",n),r.a.createElement("ul",null,r.a.createElement("a",{href:o}," ",o)),r.a.createElement("ul",{className:"vote-button"},l," votes ",r.a.createElement("button",{id:"vote-button",onClick:u},"vote"))))},f=n(47),g=function(e){var t=e.blogs,n=e.addVote,a=e.removeBlog;return r.a.createElement("div",{className:"blogs"},r.a.createElement(f.a,{striped:!0},r.a.createElement("tbody",null,t.sort((function(e,t){return t.votes-e.votes})).map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement(m,{key:e.id,title:e.title,author:e.author,url:e.url,votes:e.votes,id:e.id,addVote:function(){return n(e.id)},removeBlog:function(){return a(e.id)}}))})))))},v=n(4),b=n.n(v),p=null,h={getAll:function(){return b.a.get("/api/blogs").then((function(e){return e.data}))},create:function(){var e=Object(i.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:p}},e.next=3,b.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return b.a.put("".concat("/api/blogs","/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){p="bearer ".concat(e)},remove:function(e){var t={headers:{Authorization:p}};return b.a.delete("".concat("/api/blogs","/").concat(e),t).then((function(e){return e.data}))}},E=null,w={getAll:function(){return b.a.get("/api/users").then((function(e){return e.data}))},create:function(){var e=Object(i.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:E}},e.next=3,b.a.post("/api/users",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return b.a.put("".concat("/api/users","/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){E="bearer ".concat(e)},remove:function(e){var t={headers:{Authorization:E}};return b.a.delete("".concat("/api/users","/").concat(e),t).then((function(e){return e.data}))}},O={login:function(){var e=Object(i.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},j=function(e){var t=e.message;return null===t?null:r.a.createElement("div",{className:t.type},t.message)},y=function(e){var t=e.handleSubmit,n=e.handleUsernameChange,a=e.handlePasswordChange,o=e.username,l=e.password;return r.a.createElement("div",{className:"loginForm"},r.a.createElement("h2",null,"Login"),r.a.createElement("form",{onSubmit:t},r.a.createElement("div",null,"username",r.a.createElement("input",{id:"user-name",value:o,onChange:n})),r.a.createElement("div",null,"password",r.a.createElement("input",{id:"pass-word",type:"password",value:l,onChange:a})),r.a.createElement("button",{id:"login-button",type:"submit"},"login")))},k=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),o=Object(d.a)(n,2),l=o[0],u=o[1],c={display:l?"none":""},i={display:l?"":"none"},s=function(){u(!l)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:s}})),r.a.createElement("div",null,r.a.createElement("div",{style:c},r.a.createElement("button",{onClick:s},e.buttonLabel)),r.a.createElement("div",{style:i},e.children,r.a.createElement("button",{onClick:s},"cancel")))}));k.displayName="Togglable";var C=k,S=function(e){var t=e.createBlog,n=Object(a.useState)(""),o=Object(d.a)(n,2),l=o[0],u=o[1],c=Object(a.useState)(""),i=Object(d.a)(c,2),s=i[0],m=i[1],f=Object(a.useState)(""),g=Object(d.a)(f,2),v=g[0],b=g[1];return r.a.createElement("div",null,r.a.createElement("h2",null,"Create a new blogpost"),r.a.createElement("form",{className:"container",onSubmit:function(e){e.preventDefault(),t({title:l,author:s,url:v,votes:0}),u(""),m(""),b("")}},r.a.createElement("p",null,"title: ",r.a.createElement("input",{id:"title",value:l,onChange:function(e){u(e.target.value)}})),r.a.createElement("p",null,"author: ",r.a.createElement("input",{id:"author",value:s,onChange:function(e){m(e.target.value)}})),r.a.createElement("p",null,"address: ",r.a.createElement("input",{id:"url",value:v,onChange:function(e){b(e.target.value)}})),r.a.createElement("p",null,r.a.createElement("button",{id:"add-button",type:"submit"},"add"))))},N=function(e){var t=e.createUser,n=e.user,o=Object(a.useState)(""),l=Object(d.a)(o,2),u=l[0],c=l[1],i=Object(a.useState)(""),s=Object(d.a)(i,2),m=s[0],f=s[1],g=Object(a.useState)(""),v=Object(d.a)(g,2),b=v[0],p=v[1],h=Object(a.useState)(""),E=Object(d.a)(h,2),w=E[0],O=E[1];return r.a.createElement("div",null,r.a.createElement("h2",null,"Create a new user"),r.a.createElement("form",{className:"userForm",onSubmit:function(e){null===n?w!==m?(console.log("Passwords do not match"),window.alert("Passwords do not match"),e.preventDefault(),O("")):(e.preventDefault(),t({blogs:[],name:b,username:u,password:m}),p(""),c(""),f(""),O("")):(console.log("please log out first"),window.alert("You must be logged out"),e.preventDefault())}},r.a.createElement("div",null,"name",r.a.createElement("input",{id:"new-name",value:b,onChange:function(e){p(e.target.value)}})),r.a.createElement("div",null,"username",r.a.createElement("input",{id:"new-username",value:u,onChange:function(e){c(e.target.value)}})),r.a.createElement("div",null,"password",r.a.createElement("input",{id:"new-password",type:"password",value:m,onChange:function(e){f(e.target.value)}})),r.a.createElement("div",null,"confirm password",r.a.createElement("input",{id:"confirm-password",type:"password",value:w,onChange:function(e){O(e.target.value)}})),r.a.createElement("button",{id:"create-button",type:"submit"},"create")))},T=function(e){var t=e.userForm,n=e.user,a=e.loginForm,o=e.handleLogout,l=e.blogForm;return r.a.createElement("div",null,null===n?a():r.a.createElement("div",null,r.a.createElement("p",{className:"userName"},n.name," logged in"),r.a.createElement("button",{onClick:o},"log out"),l()),null===n?t():null)},B=function(e){var t=Object(a.useState)(e.blogs),n=Object(d.a)(t,2),o=n[0],l=n[1],u=Object(a.useState)(""),m=Object(d.a)(u,2),f=m[0],v=m[1],b=Object(a.useState)(""),p=Object(d.a)(b,2),E=p[0],k=p[1],B=Object(a.useState)(null),L=Object(d.a)(B,2),x=L[0],U=L[1],V=Object(a.useState)(null),D=Object(d.a)(V,2),F=D[0],A=D[1];Object(a.useEffect)((function(){h.getAll().then((function(e){l(e)})).catch((function(e){alert("There has been an error fetching your blogs.",e)}))}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedNoteappUser");if(e){var t=JSON.parse(e);U(t),h.setToken(t.token)}}),[]);var I=function(e){Y.current.toggleVisibility(),w.create(e).then((function(e){console.log("returnedUser:",e),J("User created!"),console.log("User created!"),setTimeout((function(){J(null)}),5e3)})).catch((function(e){J("Error, user was not created! Check all fields.","error"),console.log("error is:",e),setTimeout((function(){J(null)}),5e3)}))},z=function(e){R.current.toggleVisibility(),h.create(e).then((function(e){l(o.concat(e)),console.log(e),J("Blog added!"),console.log("Blog added!"),setTimeout((function(){J(null)}),5e3)})).catch((function(e){J("Error, your blog was not added! Check all fields.","error"),console.log("Error, your blog was not added! Check all fields. Error:",e),setTimeout((function(){J(null)}),5e3)}))},J=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";A({message:e,type:t}),setTimeout((function(){A(null)}),6e3)},P=function(){var e=Object(i.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,O.login({username:f,password:E});case 4:n=e.sent,window.localStorage.setItem("loggedNoteappUser",JSON.stringify(n)),h.setToken(n.token),U(n),v(""),k(""),J("login successful!"),console.log("Login successful!"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),J("Incorrect login!","error"),console.log("Incorrect login!");case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),Y=r.a.createRef(),R=r.a.createRef();return r.a.createElement("div",{className:"mainBody"},r.a.createElement("h1",null,"Blog Logger"),r.a.createElement("p",null,"Enter new found blogs that peak your interest and let others vote on them!"),r.a.createElement(j,{message:F}),r.a.createElement(T,{userForm:function(){return r.a.createElement(C,{buttonLabel:"create user",ref:Y},r.a.createElement(N,{createUser:I}))},user:x,loginForm:function(){return r.a.createElement(C,{buttonLabel:"login"},r.a.createElement(y,{username:f,password:E,handleUsernameChange:function(e){var t=e.target;return v(t.value)},handlePasswordChange:function(e){var t=e.target;return k(t.value)},handleSubmit:P}))},handleLogout:function(e){e.preventDefault();try{window.localStorage.clear(),J("You have been logged out!"),console.log("You have been logged out!"),window.location.reload(!1)}catch(t){J("Logout failed!","error"),console.log("Logout failed!"),setTimeout((function(){J(null)}),5e3)}},blogForm:function(){return r.a.createElement(C,{buttonLabel:"new blog",ref:R},r.a.createElement(S,{createBlog:z}))}}),r.a.createElement(g,{blogs:o,id:e.id,votes:e.votes,addVote:function(e){var t=o.find((function(t){return t.id===e})),n=Object(s.a)(Object(s.a)({},t),{},{votes:t.votes+1});h.update(e,n).then((function(t){l(o.map((function(n){return n.id!==e?n:t})))})).catch((function(e){alert("Voting error!"),console.log(e,"Voting error!")}))},removeBlog:function(e){var t=o.find((function(t){return t.id===e}));window.confirm("Delete ".concat(t.title))&&h.remove(e).then((function(n){l(o.filter((function(t){return t.id!==e}))),J("Deleted ".concat(t.title)),console.log("Blog removed!"),setTimeout((function(){J(null)}),5e3)})).catch((function(e){J("".concat(t.title," was NOT removed!"),"error"),console.log("".concat(t.title," was NOT removed! Error: "),e),console.log("You must be the creator of this submission to remove it"),setTimeout((function(){J(null)}),5e3)}))}}))};n(44);l.a.render(r.a.createElement(B,{blogs:[]}),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.ae02934d.chunk.js.map